<?xml version="1.0"?>

<language root="bnf">
  
  <!--Non-Terminals-->
  <non-terminal name="bnf">
    <sequence>
      <symbol name="production"/>
      <sequence min-occurs="0" max-occurs="unbounded">
        <symbol name="new-line" max-occurs="unbounded"/>
        <symbol name="production"/>
      </sequence>
    </sequence>
  </non-terminal>

  <non-terminal name="production">
    <sequence>
      <symbol name="symbol"/>
      <symbol name="whitespace"/>
      <symbol name="rewrite-op"/>
      <symbol name="whitespace"/>
      <symbol name="rule"/>
    </sequence>
  </non-terminal>

  <non-terminal name="rule">
    <choice>
      <symbol name="literal"/>
      <symbol name="pattern"/>
      <symbol name="grouping"/>
    </choice>
  </non-terminal>

  <non-terminal name="grouping">
    <sequence>
      <choice>
        <symbol name="choice"/>
        <symbol name="set"/>
        <symbol name="sequence"/>
      </choice>
      <symbol name="cardinality"/>
    </sequence>
  </non-terminal>

  <non-terminal name="choice">
    <sequence>
      <symbol name="q-mark"/>
      <symbol name="ls-brace"/>
      <symbol name="whitespace" min-occurs="0"/>
      <symbol name="value"/>
      <sequence min-occurs="0" max-occurs="unbounded">
        <symbol name="whitespace"/>
        <symbol name="value"/>
      </sequence>
      <symbol name="whitespace" min-occurs="0"/>
      <symbol name="rs-brace"/>
    </sequence>
  </non-terminal>

  <non-terminal name="set">
    <sequence>
      <symbol name="hash"/>
      <symbol name="ls-brace"/>
      <symbol name="whitespace" min-occurs="0"/>
      <symbol name="value"/>
      <sequence min-occurs="0" max-occurs="unbounded">
        <symbol name="whitespace"/>
        <symbol name="value"/>
      </sequence>
      <symbol name="whitespace" min-occurs="0"/>
      <symbol name="rs-brace"/>
    </sequence>
  </non-terminal>

  <non-terminal name="sequence">
    <sequence>
      <symbol name="plus"/>
      <symbol name="ls-brace"/>
      <symbol name="whitespace" min-occurs="0"/>
      <symbol name="value"/>
      <sequence min-occurs="0" max-occurs="unbounded">
        <symbol name="whitespace"/>
        <symbol name="value"/>
      </sequence>
      <symbol name="whitespace" min-occurs="0"/>
      <symbol name="rs-brace"/>
    </sequence>
  </non-terminal>

  <non-terminal name="value">
    <choice>
      <symbol name="symbol-ref"/>
      <symbol name="grouping"/>
    </choice>
  </non-terminal>

  <non-terminal name="symbol-ref">
    <sequence>
      <symbol name="symbol"/>
      <symbol name="cardinality"/>
    </sequence>
  </non-terminal>

  <non-terminal name="literal">
    <choice>
      <symbol name="case-sensitive" />
      <symbol name="case-insensitive" />
    </choice>
  </non-terminal>

  <non-terminal name="case-sensitive">
    <sequence>
      <symbol name="quote"/>
      <!--this is a non-terminal regex that describes escapable strings that lie between the " symbol. -->
      <symbol name="case-literal"/>
      <symbol name="quote"/>
    </sequence>
  </non-terminal>

  <non-terminal name="case-insensitive">
    <sequence>
      <symbol name="squote"/>
      <!--this is a non-terminal regex that describes escapable strings that lie between the ' symbol. -->
      <symbol name="non-case-literal"/>
      <symbol name="squote"/>
    </sequence>
  </non-terminal>

  <non-terminal name="pattern">
    <sequence>
      <symbol name="fslash"/>
      <!--this is a non-terminal regex that describes escapable strings that lie between the / symbol. -->
      <symbol name="pattern-literal"/>
      <symbol name="fslash"/>
      <symbol name="cardinality"/>
    </sequence>
  </non-terminal>

  <non-terminal name="cardinality">
    <sequence min-occurs="0" max-occurs="1">
      <symbol name="dot"/>
      <symbol name="digits"/>
      <sequence min-occurs="0" max-occurs="1">
        <symbol name="comma"/>
        <symbol name="digits" min-occurs="0" max-occurs="1"/>
      </sequence>
    </sequence>
  </non-terminal>


  <!-- Terminals-->
  <pattern
    name="symbol"
    regex="^\$[0-9a-zA-Z_](\w|-)*$"
    min-match="2"
    max-match="unbounded"/>

  <pattern
    name="whitespace"
    regex="^[ \t]+$"
    min-match="1"
    max-match="unbounded"/>

  <pattern
    name="case-literal"
    regex="^([^&quot;]|&quot;&quot;)*$"
    min-match="0"
    max-match="unbounded"/>

  <pattern
    name="non-case-literal"
    regex="^([^']|'')*$"
    min-match="0"
    max-match="unbounded"/>

  <pattern
    name="pattern-literal"
    regex="^([^/]|//)*$"
    min-match="0"
    max-match="unbounded"/>

  <pattern
    name="new-line"
    regex="^(\r\n|\r|\n)$"
    min-match="1"
    max-match="2"/>

  <pattern
    name="digits"
    regex="^\d+$"
    min-match="1"
    max-match="2"/>

  <literal
    name="comma"
    value=","/>

  <literal
    name="rewrite-op"
    value="::="/>

  <literal
    name="q-mark"
    value="?"/>

  <literal
    name="fslash"
    value="/"/>

  <literal
    name="plus"
    value="+"/>

  <literal
    name="hash"
    value="#"/>

  <literal
    name="squote"
    value="'"/>

  <literal
    name="quote"
    value="&quot;"/>

  <literal
    name="ls-brace"
    value="["/>

  <literal
    name="rs-brace"
    value="]"/>

  <literal
    name="dot"
    value="."/>
  
</language>